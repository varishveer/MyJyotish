@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    ViewData["Title"] = "SignUpUser";
    Layout = null;
}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

<div class="container vh-100 d-flex align-items-center justify-content-center">

    <div class="col-md-6">
        <div class="text-center">
            <img alt="flag" class="img-fluid " style="width: 200px; height: 200px;" src="https://api.myjyotishg.in/Images/Logo.png" onclick=" window.location.href = '/Home/Homepage';">
        </div>
         <h6 class="text-secondary">
            <span>You will receive a 4 digit code</span>
            <br> for verification
        </h6>
        <div class="mobile_number_enter_section">
            <h6 class="text-muted">Enter your phone number</h6>
            <div class="d-flex align-items-center mb-3">
                <div class="mr-2">
                   
                </div>
                <select name="countryCodes" class="custom-select mr-2">
                    <option value="+91" selected>+91 India</option>
                    <!-- Add other countries here -->
                </select>
                <input id="mobileNo" name="mobNo" type="text" class="form-control" placeholder="Enter mobile no." pattern="[1-9]{1}[0-9]{9}" required>
            </div>
            <button class="btn btn-primary btn-block" id="get_otp_btn">
                GET OTP
                <i class="fa fa-arrow-right ml-2"></i>
            </button>
            <div class="mt-3 text-muted">
                <p class="small">
                    By Signing up, you agree to our
                    <a href="" class="text-primary">Terms of Use</a> and
                    <a href="" class="text-primary">Privacy Policy</a>
                </p>
            </div>
        </div>
    </div>
</div>





<script>
    function sendMobileNumber() {
        const mobileNumber = $('#mobileNo').val();

        
        const mobileNumberPattern = /^[1-9][0-9]{9}$/;

        if (!mobileNumber) {
            alert('Please enter a mobile number.');
            return;
        } else if (!mobileNumberPattern.test(mobileNumber)) {
            alert('Please enter a valid 10-digit mobile number ');
            return;
        }

        
       // var Url = `https://localhost:7118/Api/Account/RegisterUserMobile?Mobile=${encodeURIComponent(mobileNumber)}`;
        var Url = `https://api.myjyotishg.in/api/Account/RegisterUserMobile?Mobile=${encodeURIComponent(mobileNumber)}`;
     
        $.ajax({
            url: Url,
            method: 'POST', 
            success: function (data, textStatus, xhr) {
                const statusCode = xhr.status;
                debugger;
                
                    
               
                if (data.status === 200) {
                    console.log('OTP sent successfully:', data);
                    alert('OTP sent successfully to ' + mobileNumber);
                  
                    localStorage.setItem('Mobile', mobileNumber);
                    window.location.href = '/Home/OtpVerification';
                    alert(data.message);
                }
                else if (data.status === 409) {

                    alert(data.message);
                } else if (data.status === 500) {

                    alert(data.message || 'An unexpected error occurred.');
                } else {

                    alert('Error sending OTP. Please try again.');
                }
               
            },
            error: function (xhr, status, error) {
                const statusCode = xhr.status;
                const response = xhr.responseJSON;
                debugger;
               
                console.error('Error:',response.message);
            }
        });
    }

   
    $('#get_otp_btn').on('click', function (event) {
        event.preventDefault(); 
        sendMobileNumber(); 
    });
</script>