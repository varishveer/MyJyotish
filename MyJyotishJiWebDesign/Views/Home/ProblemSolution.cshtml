@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}

<style>
    .problemSolution-cont {
        margin-top: 4rem;
        margin-bottom: 4rem;
    }

    body {
        background: url("https://api.myjyotishg.in/astrologer-bg.jpg");
        background-attachment: fixed;
        backdrop-filter: blur(3px);
    }

    .problemSolution > div {
        background: rgba(255, 255, 255, 0.7);
    }   

    .problem-card {
        background: rgba(255, 255, 255, 0.9); /* Slightly more opaque background */
        transition: transform 0.2s;
    }

        .problem-card:hover {
            transform: scale(1.02); /* Scale up on hover */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); /* Add shadow effect */
        }



   
</style>

<div class="container problemSolution-cont">
    <div class="row">
        <h4 class="fw-bold pb-3 border-bottom text-center">
            Problem Solution
        </h4>
        <div class="col-sm-12 my-3">
            <div class="accordion row" id="accordionExample">
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        function reverseDate(dateString) {
            const parts = dateString.split('-');
            return `${parts[2]}-${parts[1]}-${parts[0]}`;
        }

        var appoinmentUrl = BaseUrl + `api/User/getAllProblemSolution?Id=${localStorage.getItem('userId')}`;
        let ProblemSolutionArray = [];

        $.ajax({
            url: appoinmentUrl,
            method: 'GET',

            headers: {
                'Authorization': `Bearer ${localStorage.getItem("Token")}`,
                'Content-Type': 'application/json',
            },
            success: function (response) {
                ProblemSolutionArray = response.data || [];
                filterRecords(); // Call filterRecords after data is loaded
            },
            error: function (err) {
                console.log(err);
            }
        });


        function formatDate(isoDate) {
            let date = new Date(isoDate);
            return date.toLocaleDateString('en-GB'); // Formats as DD/MM/YYYY
        }
        function filterRecords() {
            let newSolution = ProblemSolutionArray;

            // $(".problemSolution").empty();

            if (newSolution.length > 0) {
                let pi=1
                newSolution.forEach(function (d) {
                    let cards = `
            <div class="col-sm-6 col-md-6 mb-3">
                 <div class="accordion-item">
                            <h2 class="accordion-header" id="heading_${d.appointmentId}">
                                    <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse_${d.appointmentId}" aria-expanded="true" aria-controls="collapse_${d.appointmentId}">
                                Accordion Item #1
                            </button>
                        </h2>
                                <div id="collapse_${d.appointmentId}" class="accordion-collapse collapse" aria-labelledby="heading_${d.appointmentId}" data-bs-parent="#accordionExample">
                            <div class="accordion-body">
                                    <a href="/home/ProblemSolutionDetails?Id=${d.appointmentId}" class="text-decoration-none text-dark">
                                        <strong>Name:</strong> ${d.jyotishName}<br />
                                        <strong>Date:</strong> ${formatDate(d.date)}<br />
                                        <strong>Time:</strong> ${d.time.substring(0, 5)}<br />
                            </div>
                        </div>
                    </div>
            </div>`;
                    $("#accordionExample").append(cards);
                });
            } else {
                $(".problemSolution").html(`<p class='my-5 text-center text-secondary'>There are no appointments yet.</p>`);
            }
        }
    });
</script>
