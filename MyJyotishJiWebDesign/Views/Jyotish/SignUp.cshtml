@{
    Layout = "Extra";
     string BaseUrl = "https://api.myjyotishg.in/";
}
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

<style>
    .container {
        margin-top: 50px;
        margin-bottom: 50px;
    }

   
    .left-part {

        border-radius: 10px 0px 0px 10px;
        box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.2);
        padding: 15px;
    }

    .right-part {
     
        border-radius: 0px 10px 10px 0px;
        box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.2);
        padding: 30px;
        background-color: white;
    }

    .responsive-image {
        max-width: 100%;
        height: auto;
        border-radius: 10px;
    }

    h2 {
        margin-bottom: 20px;
        color:black; 
    }

    .btn-primary {
        border-radius: 6px;
    }

    .form-group {
        margin-bottom: 0.5rem; /* Adjust this value as needed */
    }

    .form-label {
        margin-bottom: 0.2rem; /* Reduce space between label and input */
        font-size:16px;
    }

    .input-group {
        margin-bottom: 0.5rem; /* Reduce space between input groups */
    }

    .form-control{
        font-size: 12px;
    }

    .form-select{
        font-size: 12px;
    }

    .btn:not(:disabled):not(.disabled){
        font-size:12px;
    }

    .otpcolour {
        color:white;
        background-color:lightslategray;
    }

</style>

<div class="container h-80 ">
    <div class="row w-70">
        <div class="col-md-5 left-part d-flex justify-content-center align-items-center">
            <img src="/Img/mobile-login.jpg" alt="Sign Up Image" class="responsive-image">
        </div>
         <div class="col-md-7 right-part">
    <h2 class="mb-3 d-flex justify-content-center">Sign Up</h2>
            <form id="registrationForm">
        <div class="form-row">
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                        <label for="name" class="form-label" style="margin-bottom: 0.2rem;">Name:</label>
                <input type="text" id="name" name="name" placeholder="Enter your name" class="form-control" required>
            </div>
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                <label for="email" class="form-label">Email:</label>
                <div class="input-group">
                    <input type="email" id="email" name="email" class="form-control" placeholder="Enter your email" aria-label="Recipient's username" required>
                            <button class="btn btn-outline-secondary otpcolour" type="button" id="getOtp">Get OTP</button>
                </div>
            </div>
        </div>
        
        <div class="form-row">
                    <div class="form-group col-md-12" style="margin-bottom: 0.2rem;">
                        <label for="otp" class="form-label" style="display:none">Verification:</label>
                <div class="input-group">
                            <input type="number" id="otp" name="otp" class="form-control" style="display:none" placeholder="Enter OTP" required>
                            <button class="btn btn-outline-secondary" type="button" id="verifyOtp" style="display:none">Verify OTP</button>
                </div>
            </div>
        </div>

        <div class="form-row">
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                <label for="mobile" class="form-label">Number:</label>
                        <input type="tel" id="mobile" name="mobile" class="form-control" placeholder="Mobile Number" required>
            </div>
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                <label for="gender" class="form-label">Gender:</label>
                <select id="gender" name="gender" class="form-select" required>
                    <option value="Male" selected>Male</option>
                    <option value="Female">Female</option>
                    <option value="Other">Other</option>
                </select>
            </div>
        </div>

        <div class="form-row">
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                <label for="language" class="form-label">Language:</label>
                <select id="language" name="language" class="form-select" required>
                    <option value="">Select Language</option>
                    <!-- Add language options here -->
                </select>
            </div>
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                <label for="expertise" class="form-label">Expertise:</label>
                    <select id="expertise" name="expertise" class="form-select" required>
                    <option value="">Select Expertise</option>
                    <!-- Add expertise options here -->
                </select>
            </div>
        </div>

                <div class="form-row">
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                        <label for="country" class="form-label">Country:</label>
                        <select id="country" name="country" class="form-select" required>
                            <option value="">Select Country</option>
                            <!-- Add country options here -->
                        </select>
                    </div>
                    <div class="form-group col-md-6" style="margin-bottom: 0.2rem;">
                        <label for="Image" class="form-label">Profile Images:</label>
                        <input type="file" id="Image"  class="form-control" />
                    </div>
                </div>
        
        <div class="form-row">
              <div class="form-group col-md-6" style="margin-bottom: 0.6rem;">
                  <label for="state" class="form-label">State:</label>
                  <select id="state" name="state" class="form-select" disabled>
                      <option value="">Select State</option>
                      <!-- Add state options here -->
                  </select>
              </div>
            <div class="form-group col-md-6" style="margin-bottom: 0.6rem;">
                <label for="city" class="form-label">City:</label>
                <select id="city" name="city" class="form-select" disabled>
                    <option value="">Select City</option>
                    <!-- Add city options here -->
                </select>
            </div>
         
        </div>

        <button type="submit" class="btn btn-info">Sign Up</button>

            <div class="form-row mt-3" style="margin-bottom: 0.2rem;">
                    <div class="form-group col-md-12" style="margin-bottom: 0.2rem;">
                <p>
                    By submitting this form, you agree to our
                    <a href="#" class="text-info">Privacy Policy</a> and
                    <a href="#" class="text-info">Terms of Service</a>.
                </p>
            </div>
            <div class="d-flex justify-content-center">
                <p class="mb-0">Already have an account?</p>
                <a href="/Jyotish/Login">Login</a>
            </div>
         </div>
      </form>
     </div>

      
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>





<script>
    $(document).ready(function () {
       
        $("#getOtp").click(function () {
            var email = document.getElementById("email").value;
            // Use jQuery to get the value

            $.ajax({
                url: "@BaseUrl" + `Api/Account/RegisterJyotish?email=${encodeURIComponent(email)}`,
                type: 'POST',
                contentType: 'application/json', // Set content type to JSON

                success: function () {
               
                    alert("OTP send successful.");
                    $("#otpLabel").show();
                    $("#verifyOtp").show();
                    $('#otp').show();
                },
                error: function (xhr) {
                   
                    alert("Error: " + xhr.status + " - " + xhr.statusText );
                }
            });
        });


        $("#verifyOtp").click(function () {
            var email = document.getElementById("email").value;
            var otp = document.getElementById("otp").value;

            // Create the data object to send
            var data = {
                Email: email, // Match the property name in the model
                Otp: otp
            };
            debugger;
            $.ajax({
                url: "@BaseUrl"+`Api/Account/VerifyJyotish`,
                type: 'POST',
                contentType: 'application/json',
                data: JSON.stringify(data), // Send the data as a JSON string

                success: function (response) {
                    debugger;
                    // Handle different status messages based on the response
                    switch (response.status) {
                        case 200:
                            alert("OTP Check successful: " + response.message);
                            break;
                        case 409:
                            alert("Conflict: " + response.message);
                            break;
                        case 400:
                            alert("Bad Request: " + response.message);
                            break;
                        case 500:
                            alert("Internal Server Error: " + response.message);
                            break;
                        default:
                            alert("Unexpected response: " + response.message);
                            break;
                    }
                },
                error: function (xhr) {
                    debugger;
                    alert("Error: " + xhr.status + " - " + xhr.statusText);
                }
            });
        });



        async function loadLanguage() {
            try {
                const response = await fetch("@BaseUrl"+'Api/Account/Languages');
                const data = await response.json();
                const $languageDropdown = $('#language');
                $languageDropdown.html('<option value="">Select Language</option>');

                data.data.forEach(language => {
                    $languageDropdown.append(`<option value="${language}">${language}</option>`);
                });
            } catch (error) {
                console.error('Error fetching Language:', error);
            }
        }

        const $countryDropdown = $('#country');
        const $stateDropdown = $('#state');
        const $cityDropdown = $('#city');

        async function loadExpertise() {
            try {
                const response = await fetch("@BaseUrl"+'Api/Jyotish/Expertise');
                const data = await response.json();
                const $expertiseDropdown = $('#expertise');
                $expertiseDropdown.html('<option value="">Select Expertise</option>');

                data.data.forEach(expertise => {
                    $expertiseDropdown.append(`<option value="${expertise.name}">${expertise.name}</option>`);
                });
            } catch (error) {
                console.error('Error fetching expertise:', error);
            }
        }

        async function loadCountries() {
            try {
                const response = await fetch("@BaseUrl"+'Api/Jyotish/Country');
                const data = await response.json();
                $countryDropdown.html('<option value="">Select Country</option>');

                data.data.forEach(country => {
                    $countryDropdown.append(`<option value="${country.id}" data-countryName="${country.name}">${country.name}</option>`);
                });
            } catch (error) {
                console.error('Error fetching countries:', error);
            }
        }

        async function loadStates(countryId) {
            try {
                const response = await fetch("@BaseUrl"+`Api/Jyotish/State?Id=${countryId}`);
                const data = await response.json();
                $stateDropdown.html('<option value="">Select State</option>');

                data.data.forEach(state => {
                    $stateDropdown.append(`<option value="${state.id}">${state.name}</option>`);
                });

                $stateDropdown.prop('disabled', false);
            } catch (error) {
                console.error('Error fetching states:', error);
            }
        }

        async function loadCities(stateId) {
            try {
                const response = await fetch("@BaseUrl"+`Api/Jyotish/City?Id=${stateId}`);
                const data = await response.json();
                $cityDropdown.html('<option value="">Select City</option>');

                data.data.forEach(city => {
                    $cityDropdown.append(`<option value="${city.id}" data-name="${city.name}">${city.name}</option>`);
                });

                $cityDropdown.prop('disabled', false);
            } catch (error) {
                console.error('Error fetching cities:', error);
            }
        }
        loadLanguage();
        loadExpertise();
        loadCountries();

        $countryDropdown.change(function () {
            const countryId = $(this).val();
            if (countryId) {
                loadStates(countryId);
            } else {
                $stateDropdown.html('<option value="">Select State</option>').prop('disabled', true);
                $cityDropdown.html('<option value="">Select City</option>').prop('disabled', true);
            }
        });

        $stateDropdown.change(function () {
            const stateId = $(this).val();
            if (stateId) {
                loadCities(stateId);
            } else {
                $cityDropdown.html('<option value="">Select City</option>').prop('disabled', true);
            }
        });

        $('#registrationForm').on("submit", function (event) {
            event.preventDefault();
            debugger;
            const formData = new FormData(this); // Use FormData for file uploads

            $.ajax({
                url: "@BaseUrl" + 'Api/Account/SignUpJyotish',
                type: 'POST',
                data: formData,
                processData: false, // Important for file uploads
                contentType: false, // Important for file uploads
                success: function (response) {
                    debugger;
                    console.log('Success:', response);
                    alert('Form submitted successfully!');
                    $('#registrationForm')[0].reset(); // Reset the form
                },
                error: function (xhr, status, error) {
                    debugger;
                    console.error('Error:', error);
                    console.log('XHR:', xhr.statusCode);
                    alert('There was an error submitting the form.');
                }
            });
        });
    });
</script>

