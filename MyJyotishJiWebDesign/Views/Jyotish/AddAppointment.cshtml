
@{
    Layout = "JyotishLayout";
   
}

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<style>
    .main-container {
        overflow: hidden;
        padding: 15px;
        border-radius: 0px 10px 10px 0px;
        box-shadow: 0px 0px 3px 0px rgba(0, 0, 0, 0.3);
    }

    .left-part img {
        max-width: 100%;
        height: auto;
        border-radius: 10px;
        border-radius: 10px 0px 0px 10px;
    }

    .right-part form input, .right-part form button {
        font-size: 13px;
    }

    .right-part button {
        background-color: #138496;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

        .right-part button:hover {
            background-color: #138496;
            color: white;
        }
</style>

<div class="container d-flex justify-content-center align-items-center min-vh-90 mt-4">
    <div class="main-container row w-75 rounded-3">
        <!-- Left part for image -->
        <div class="col-md-4 left-part d-flex justify-content-center align-items-center">
            <img src="~/gif/3885914.jpg" alt="Sign Up Image" class="responsive-image" />
        </div>

        <!-- Right part for the signup form -->
        <div class="col-lg-8 col-md-12 p-2 bg-white right-part ">
            <h5 class="mb-3 text-center">Schedule an Appointment</h5>
            <form id="appointmentForm">
                

               
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="name" class="form-label">Name</label>
                        <input type="text" class="form-control" id="name">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="email" class="form-label">Email</label>
                        <input type="email" class="form-control" id="email" placeholder="Enter your email">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="mobile" class="form-label">Mobile</label>
                        <input type="text" class="form-control" id="mobile" >
                    </div>
                   
                </div>

                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="problem" class="form-label">Problem</label>
                        <textarea class="form-control" id="problem"></textarea>
                     @*   <input type="" class="form-control" id="problem"> *@
                    </div>

                </div>
                <div class="form-row">
                    <div class="form-group col-md-12">
                        <label for="list" class="form-label">List</label>
                        <select id="yourSelectElementId"></select>
                      
                    </div>
                </div>

           
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <button type="submit" class="btn btn-info px-3 ">Submit</button>
                    </div>
                </div>


            </form>
        </div>
    </div>
</div>




<script>
    $(document).ready(function () {

        $.ajax({
            url: BaseUrl +`Api/Jyotish/GetAllAppointmentSlot?Id=${localStorage.getItem('Id')}`,
            type: 'GET',
            headers: {
                'Authorization': `Bearer ${localStorage.getItem("Token2")}`,
                'Content-Type': 'application/json',
            },
            success: function (res) {
                 
                // Loop through the response data
                $.each(res.data, function (index, item) {
                    // For each date, loop through the slotList to append options
                    $.each(item.slotList, function (slotIndex, slot) {
                        $('#yourSelectElementId').append(`
                        <option value="${slot.id}">
                            ${item.date.split('T')[0]} - ${slot.timeFrom} to ${slot.timeTo}
                            (${slot.timeDuration} mins, Status: ${slot.status})
                        </option>
                    `);
                    });
                });
            },
            error: function (error) {
                 
                console.error(error);
            }
        });












        $('#appointmentForm').on('submit', function (event) {
             
            event.preventDefault(); // Prevent default form submission
          

            // Capture form data
            var formData = {
              
                email: $('#email').val(),
                name: $('#name').val(),
                mobile: $('#mobile').val(),
                jyotishId: localStorage.getItem('Id'),
                problem: $('#problem').val(),
                slotId: $('#yourSelectElementId').val(),
              
            };
             
            // Send data using AJAX
            $.ajax({
                url: BaseUrl+ 'Api/Jyotish/AddAppointment', // Replace with your API endpoint
                type: 'POST',
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem("Token2")}`, // Example of an authorization header
                    'Content-Type': 'application/json', // Example of a content type header

                },
                data: JSON.stringify(formData),
                contentType: 'application/json; charset=utf-8',
                dataType: 'json',
               
                success: function (response) {
                    if (response.status === 200) { alert('Appointment booked successfully!'); }
                    else if (response.status === 400) {

                        alert('Invalid Data');
                    }
                    else {
                        alert(`${response.message}`);
                    }

                },
                error: function (xhr, status, error) {
                    console.error('Error submitting form:', error, status, xhr);
                    alert('An error occurred while submitting the form. Please try again.');
                }
            });
        });
    });
</script>



