@{
    Layout = "AdminLayout";
}
<style>
    td th {
        white-space: nowrap; /* Prevent text from wrapping */
    }
</style>
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
<!-- Include jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<div class="container">
    <h1>Jyotish Documents</h1>
    <div id="loading" style="display:none;">Loading...</div>
    <table id="DataTable" class="table">
        <thead>
            <tr>
                <th>Id</th>
                <th>Id Proof</th>
                <th>Address Proof</th>
                <th>Tenth Certificate</th>
                <th>Twelve Certificate</th>
                <th>Professional Certificate</th>
            </tr>
        </thead>
        <tbody>
            <!-- Data will be populated here by JavaScript -->
        </tbody>
    </table>
</div>

<script>
    $(document).ready(function () {
        // Function to get query parameter by name
        function getQueryParameter(name) {
            const params = new URLSearchParams(window.location.search);
            return params.get(name);
        }
        debugger;
        // Extract the id from the URL
        const id = getQueryParameter('id');

        function fetchData() {
            debugger;
            if (!id) {
                console.error('ID parameter is missing in the URL.');
                return; // Exit if id is not defined
            }
            $('#loading').show(); // Show loading indicator

            $.ajax({
                url: `https://api.myjyotishg.in/api/Admin/GetJyotishDocs?id=${id}`, // Use the extracted id
                type: 'GET',
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem("Token")}`,
                    'Content-Type': 'application/json'
                },
                success: function (result) {
                    debugger;
                    $('#loading').hide(); // Hide loading indicator

                    if (!result.data) {
                        alert('No data found for the provided ID.');
                        return;
                    }

                    // Extract the single record from the response
                    const record = result.data;

                    // Populate the table with data
                    $('#DataTable tbody').append(`
                            <tr>
                                <td>${record.id}</td>
                                <td><img src="${record.idProof}" alt="Id Proof" style="max-width: 100px;"></td>
                                <td><img src="${record.addressProof}" alt="Address Proof" style="max-width: 100px;"></td>
                                <td><img src="${record.tenthCertificate}" alt="Tenth Certificate" style="max-width: 100px;"></td>
                                <td><img src="${record.twelveCertificate}" alt="Twelve Certificate" style="max-width: 100px;"></td>
                                <td><img src="${record.professionalCertificate}" alt="Professional Certificate" style="max-width: 100px;"></td>
                            </tr>
                        `);
                },
                error: function (errormessage) {
                    debugger;
                    $('#loading').hide(); // Hide loading indicator
                    console.error('Error fetching data:', errormessage.responseText);
                    alert('An error occurred while fetching data. Please try again later.');
                }
            });
        }

        // Load data if the id is defined
        fetchData();
    });
</script>
