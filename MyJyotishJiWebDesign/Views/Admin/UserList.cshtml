@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = "AdminLayout";
}



<style>
    td, th {
        white-space: nowrap; /* Prevent text from wrapping */
    }

    thead, th {
        background-color: rgb(2, 156, 255);
        color: white;
        font-weight: 300 !important;
    }
</style>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<link href="https://cdn.datatables.net/2.1.3/css/dataTables.dataTables.min.css" rel="stylesheet" />
<script src="https://cdn.datatables.net/2.1.3/js/dataTables.min.js"></script>
<div class="container-fluid pt-4 px-4">
    <div class="bg-light text-center rounded p-4">
        <div class="d-flex align-items-center justify-content-between mb-4">
            <h6 class="mb-0">User List</h6>

        </div>
        <div class="table-responsive">
            <table id="DataTable" class="table text-start align-middle table-bordered table-hover mb-0">
              
            </table>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
            function fetchData() {
                const token = localStorage.getItem("Token"); // Assuming Token is already set in localStorage
                $.ajax({
                    url: "https://api.myjyotishg.in/api/Admin/User", // Your API URL
                    type: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`, // Authorization header with Bearer token
                        'Content-Type': 'application/json'
                        },
                    success: function (result) {
                        // Define table structure including all fields from the model
                        let htmls = `
                            <thead>
                            <tr>
                                <th>Id</th>
                                <th>Email</th>
                                <th>Mobile</th>
                                <th>Name</th>
                                <th>Gender</th>
                                <th>Date of Birth</th>
                                    <th>Place of Birth</th>
                                    <th>OTP</th>
                                <th>Password</th>
                                <th>Time of Birth</th>
                                    <th>Current Address</th>
                                <th>Country</th>
                                <th>State</th>
                                <th>City</th>
                                <th>Pincode</th>
                                <th>Profile Picture</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>`;

                        // Loop through the result and append each row of data
                        $.each(result.data, function (key, item) {
                            htmls += '<tr>';
                                htmls += `<td class="text-center">${item.id}</td>`;
                                htmls += `<td class="text-center">${item.email || ''}</td>`;
                                htmls += `<td class="text-center">${item.mobile || ''}</td>`;
                                htmls += `<td class="text-center">${item.name || ''}</td>`;
                                htmls += `<td class="text-center">${item.gender || ''}</td>`;
                                htmls += `<td class="text-center">${item.doB || ''}</td>`;
                                htmls += `<td class="text-center">${item.placeOfBirth || ''}</td>`;
                                htmls += `<td class="text-center">${item.otp || ''}</td>`;
                                htmls += `<td class="text-center">${item.password || ''}</td>`;
                                htmls += `<td class="text-center">${item.timeOfBirth || ''}</td>`;
                                htmls += `<td class="text-center">${item.currentAddress || ''}</td>`;
                                htmls += `<td class="text-center">${item.country || ''}</td>`;
                                htmls += `<td class="text-center">${item.state || ''}</td>`;
                                htmls += `<td class="text-center">${item.city || ''}</td>`;
                                htmls += `<td class="text-center">${item.pincode || ''}</td>`;
                                htmls += `<td class="text-center">${item.profilePictureUrl ? '<img src="' + item.profilePictureUrl + '" alt="Profile Picture" width="50" height="50">' : ''}</td>`;
                                htmls += `<td class="text-center">${item.status || ''}</td>`;
                                htmls += '</tr>';
                            });

                            htmls += '</tbody>';
                            $('#DataTable').html(htmls); // Inject HTML into table
                            $('#DataTable').DataTable(); // Initialize DataTable
                        },
                        error: function (errormessage) {
                            console.error('Error fetching data:', errormessage.responseText);
                        }
                    });
                }

                // Call fetchData to load the data when the page is ready
                fetchData();
            });
</script>