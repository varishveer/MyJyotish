@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = "AdminLayout";
}



<style>
    .card-body {
        padding-left: 15px !important;
        padding-right: 15px !important;
    }
</style>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<link href="https://cdn.datatables.net/2.1.3/css/dataTables.dataTables.min.css" rel="stylesheet" />
<script src="https://cdn.datatables.net/2.1.3/js/dataTables.min.js"></script>

<div class="container-fluid mt-4">
    <div class="card">

        <div class="d-flex flex-row justify-content-between align-items-center  px-4">
            <h5 class="text-primary mt-2">User List</h5>

        </div>
        <hr />

        <div class="card-body">
            <div class="table-responsive">
                <table id="DataTable" class="table table-bordered table-striped">
                    <!-- Table content goes here -->
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
            function fetchData() {
                const token = localStorage.getItem("Token"); // Assuming Token is already set in localStorage
                $.ajax({
                    url: "https://api.myjyotishg.in/api/Admin/User", // Your API URL
                    type: 'GET',
                    headers: {
                        'Authorization': `Bearer ${token}`, // Authorization header with Bearer token
                        'Content-Type': 'application/json'
                        },
                    success: function (result) {
                        // Define table structure including all fields from the model
                        let htmls = `
                            <thead>
                            <tr>
                                <th>Id</th>
                                <th>Email</th>
                                <th>Mobile</th>
                                <th>Name</th>
                                <th>Gender</th>
                                <th>Birth Date</th>
                                    <th>Birth Place</th>
                                    <th>OTP</th>
                                <th>Password</th>
                                <th>Birth Date</th>
                                    <th>Current Address</th>
                                <th>Country</th>
                                <th>State</th>
                                <th>City</th>
                                <th>Pincode</th>
                                <th>Profile Picture</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody>`;

                        // Loop through the result and append each row of data
                        $.each(result.data, function (key, item) {
                            htmls += '<tr>';
                                htmls += `<td class="text-center">${item.id}</td>`;
                                htmls += `<td class="text-center">${item.email || ''}</td>`;
                                htmls += `<td class="text-center">${item.mobile || ''}</td>`;
                                htmls += `<td class="text-center">${item.name || ''}</td>`;
                                htmls += `<td class="text-center">${item.gender || ''}</td>`;
                                htmls += `<td class="text-center">${item.doB || ''}</td>`;
                                htmls += `<td class="text-center">${item.placeOfBirth || ''}</td>`;
                                htmls += `<td class="text-center">${item.otp || ''}</td>`;
                                htmls += `<td class="text-center">${item.password || ''}</td>`;
                                htmls += `<td class="text-center">${item.timeOfBirth || ''}</td>`;
                                htmls += `<td class="text-center">${item.currentAddress || ''}</td>`;
                                htmls += `<td class="text-center">${item.country || ''}</td>`;
                                htmls += `<td class="text-center">${item.state || ''}</td>`;
                                htmls += `<td class="text-center">${item.city || ''}</td>`;
                                htmls += `<td class="text-center">${item.pincode || ''}</td>`;
                                htmls += `<td class="text-center">${item.profilePictureUrl ? '<img src="' + item.profilePictureUrl + '" alt="Profile Picture" width="50" height="50">' : ''}</td>`;
                                htmls += `<td class="text-center">${item.status || ''}</td>`;
                                htmls += '</tr>';
                            });

                            htmls += '</tbody>';
                            $('#DataTable').html(htmls); // Inject HTML into table
                            $('#DataTable').DataTable(); // Initialize DataTable
                        },
                        error: function (errormessage) {
                            console.error('Error fetching data:', errormessage.responseText);
                        }
                    });
                }

                // Call fetchData to load the data when the page is ready
                fetchData();
            });
</script>