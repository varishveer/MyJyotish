@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    Layout = "AdminLayout";
    var BaseUrl = "https://api.myjyotishg.in/";
}


<style>
    .card-body {
        padding-left: 15px !important;
        padding-right: 15px !important;
    }
</style>


<div class="container-fluid mt-4">
    <div class="card">
   
            <div class="d-flex flex-row justify-content-between align-items-center  px-4">
                <h5 class="text-primary mt-2">Appointments</h5>
               
            </div>
            <hr />
       
        <div class="card-body">
            <div class="table-responsive">
                <table id="DataTable" class="table table-bordered table-striped">
                    <!-- Table content goes here -->
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        function fetchData() {
            $.ajax({
                url:  "@BaseUrl"+"api/Admin/Appointment",
                type: 'GET',
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem("Token")}`,
                    'Content-Type': 'application/json',
                },
                success: function (result) {
                    console.log(result); // Log the API response
                    let htmls = '<thead><tr><th>Id</th><th>Name</th><th>Mobile</th><th>DateTime</th><th>Email</th><th>JyotishId</th><th>UserId</th><th>Problem</th><th>Solution</th><th>Status</th><th>Amount</th><th>Action</th></tr></thead><tbody>';

                    $.each(result.data, function (key, item) {
                        htmls += '<tr data-id="' + item.id +
                            '" data-name="' + item.name +
                            '" data-mobile="' + item.mobile +
                            '" data-datetime="' + item.dateTime +
                            '" data-email="' + item.email +
                            '" data-jyotishid="' + item.jyotishId +
                            '" data-userid="' + item.userId +
                            '" data-problem="' + item.problem +
                            '" data-solution="' + item.solution +
                            '" data-status="' + item.status +
                            '" data-amount="' + item.amount + '">';
                        htmls += `<td class="text-center">${item.id}</td>`;
                        htmls += `<td class="text-center">${item.name}</td>`;
                        htmls += `<td class="text-center">${item.mobile}</td>`;
                        htmls += `<td class="text-center">${item.dateTime}</td>`;
                        htmls += `<td class="text-center">${item.email}</td>`;
                        htmls += `<td class="text-center">${item.jyotishId}</td>`;
                        htmls += `<td class="text-center">${item.userId}</td>`;
                        htmls += `<td class="text-center">${item.problem}</td>`;
                        htmls += `<td class="text-center">${item.solution}</td>`;
                        htmls += `<td class="text-center">${item.status}</td>`;
                        htmls += `<td class="text-center">${item.amount}</td>`;
                        htmls += `<td class="text-center">
                        <a href="UpdateAppointment?Id=${item.id}">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="1.13em" height="1em" viewBox="0 0 576 512"><path fill="currentColor" d="m402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0m162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2M384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5"/></svg>
                        </a>
                        </td>`;
                        htmls += '</tr>';
                    });

                    htmls += '</tbody>';
                    $('#DataTable').html(htmls);
                    // Initialize DataTable after the data is loaded
                    $('#DataTable').DataTable({
                        "paging": true,
                        "searching": true,
                        "ordering": true,
                        "info": true
                    });
                },
                error: function (errormessage) {
                    console.error('Error fetching data:', errormessage.responseText);
                }
            });
        }

        fetchData(); // Call the function to load data
    });
</script>





