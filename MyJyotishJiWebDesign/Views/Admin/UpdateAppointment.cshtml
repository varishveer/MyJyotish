@{
    var BaseUrl = "https://api.myjyotishg.in/";
}
<div class="container-fluid pt-4 px-4">
    <div class="bg-light text-center rounded p-4">

        <form id="requestForm">
            <div class="form-group mb-3">
                <label for="Id">Id:</label>
                <input type="text" class="form-control" id="Id" readonly>
            </div>
            <div class="form-group mb-3">
                <label for="Name">Name:</label>
                <input type="text" class="form-control" id="Name">
            </div>
            <div class="form-group mb-3">
                <label for="Mobile">Mobile:</label>
                <input type="text" class="form-control" id="Mobile">
            </div>
            <div class="form-group mb-3">
                <label for="DateTime">DateTime:</label>
                <input type="text" class="form-control" id="DateTime">
            </div>
            <div class="form-group mb-3">
                <label for="Email">Email:</label>
                <input type="text" class="form-control" id="Email">
            </div>
            <div class="form-group mb-3">
                <label for="JyotishId">JyotishId:</label>
                <input type="text" class="form-control" id="JyotishId">
            </div>
            <div class="form-group mb-3">
                <label for="UserId">UserId:</label>
                <input type="text" class="form-control" id="UserId">
            </div>
            <div class="form-group mb-3">
                <label for="Problem">Problem:</label>
                <input type="text" class="form-control" id="Problem">
            </div>
            <div class="form-group mb-3">
                <label for="Solution">Solution:</label>
                <input type="text" class="form-control" id="Solution">
            </div>
            <div class="form-group mb-3">
                <label for="Status">Status:</label>
                <input type="text" class="form-control" id="Status">
            </div>
            <div class="form-group mb-3">
                <label for="Amount">Amount:</label>
                <input type="number" class="form-control" id="Amount">
            </div>
            <button type="submit">
                Submit 
            </button>
        </form>

    
    </div>
</div>






<script>

    $(document).ready(function () {
        // Function to get the URL parameter
        function getUrlParam(param) {
            var searchParams = new URLSearchParams(window.location.search);
            return searchParams.get(param);
        }

        // Get 'Id' from the URL
        var id = getUrlParam('Id');
        $('#Id').val(id);  // Set the input field with the 'Id'

        // Make AJAX call only if 'Id' is present
        if (id) {
            $.ajax({
                url:"@BaseUrl" + 'Admin/AppointmentDetail', // Replace with your API endpoint
                type: 'GET',
                data: { Id: id }, // Pass the Id as a query parameter
                success: function (response) {
                    if (response.Status === 200) {
                        // Assuming the API returns an object with properties like name, mobile, etc.
                        var record = response.data;

                        // Load the data into the form fields
                        $('#Name').val(record.name);
                        $('#Mobile').val(record.mobile);
                        $('#DateTime').val(record.dateTime);
                        $('#Email').val(record.email);
                        $('#JyotishId').val(record.jyotishId);
                        $('#UserId').val(record.userId);
                        $('#Problem').val(record.problem);
                        $('#Solution').val(record.solution);
                        $('#Status').val(record.status);
                        $('#Amount').val(record.amount);
                    } else {
                        $('#result').html('<p>' + response.Message + '</p>');
                    }
                },
                error: function (xhr, status, error) {
                    $('#result').html('<p>Error fetching details: ' + error + '</p>');
                }
            });
        } else {
            $('#result').html('<p>No Id provided in the URL.</p>');
        }
    });


    document.getElementById('updateButton').addEventListener('click', async function () {
        // Get form data
        const formData = {
            Id: parseInt(document.getElementById('Id').value, 10),

            Name: document.getElementById('Name').value,
            Mobile: document.getElementById('Mobile').value,
            DateTime: new Date(document.getElementById('DateTime').value).toISOString(), // Convert to ISO string
            Email: document.getElementById('Email').value,
            JyotishId: parseInt(document.getElementById('JyotishId').value, 10),
            UserId: parseInt(document.getElementById('UserId').value, 10),
            Problem: document.getElementById('Problem').value,
            Solution: document.getElementById('Solution').value,
            Status: document.getElementById('Status').value,
            Amount: parseInt(document.getElementById('Amount').value, 10)
        };

        try {
            const response = await fetch('https://api.myjyotishg.in/api/Admin/UpdateAppointment', {
                method: 'POST', // Use 'PUT' if updating an existing resource
                headers: {
                    'Authorization': `Bearer ${localStorage.getItem("Token")}`, // Example authorization header
                    'Content-Type': 'application/json' // Header indicating JSON payload
                },
                body: JSON.stringify(formData) // Convert form data to JSON
            });

            if (response.status === 200) {
                const result = await response.json();
                alert('Request updated successfully!');
                console.log(result);
                $('#updateModal').modal('hide'); // Close the modal
                window.location.reload();

            } else {
                alert('Failed to update request.');
                console.error('Error:', response.statusText);
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while updating the request.');
        }
    });
</script>